# 🎵 数据收集指南 - 提高模型鲁棒性

## 📊 当前数据集状况
- ✅ **正样本**: 6个热水器开关声音（质量良好）
- ⚠️ **负样本**: 6个简单合成噪音（质量一般，容易过拟合）

## 🎯 收集策略

### 1. **优先收集的负样本类型**

#### 🏠 家庭环境声音
```
📱 电子设备
- 手机铃声、通知音
- 电视、音响声音
- 电脑风扇、硬盘声音
- 微波炉、洗衣机运行声

🚪 日常活动
- 开门关门声
- 脚步声、走路声
- 椅子移动、桌子碰撞
- 键盘敲击、鼠标点击

🗣️ 人声活动
- 正常说话、对话
- 咳嗽、打喷嚏、清嗓子
- 笑声、叹气声
- 电话通话声音
```

#### 🔧 机械/电器声音
```
⚡ 电器启动/关闭
- 空调开关机
- 冰箱压缩机启动
- 风扇开关
- 灯具开关（但要避免和热水器开关混淆）

🔨 机械操作
- 抽屉开关
- 柜门开关
- 水龙头开关
- 马桶冲水
```

### 2. **录音技巧**

#### 📱 录音设备
- 使用手机录音（与实际使用环境一致）
- 保持与热水器开关录音相同的距离
- 使用相同的录音app和设置

#### ⏱️ 录音时长
- 每个样本 2-8 秒
- 包含完整的声音事件
- 避免过长的静音段

#### 🎚️ 录音质量
- 避免削峰失真
- 保持适中的音量
- 尽量减少背景噪音

### 3. **数据标注规范**

#### 📝 文件命名
```
negative_[类别]_[编号].wav

例如:
- negative_phone_01.wav (手机铃声)
- negative_door_01.wav (开门声)
- negative_voice_01.wav (说话声)
- negative_appliance_01.wav (电器声)
```

#### 🏷️ 类别定义
```
📱 electronics: 电子设备声音
🚪 mechanical: 机械操作声音
🗣️ voice: 人声相关
🏠 ambient: 环境背景音
⚡ appliance: 家电设备
🔧 tools: 工具使用声音
```

### 4. **数据收集计划**

#### 📅 阶段性目标
```
第一阶段 (1-2周):
- 收集 50-100 个真实负样本
- 覆盖 6-8 个主要类别
- 每个类别至少 8-10 个样本

第二阶段 (2-3周):
- 收集 100-200 个负样本
- 增加边界案例（容易混淆的声音）
- 收集不同环境下的样本

第三阶段 (持续):
- 收集误报案例进行针对性训练
- 定期更新和扩充数据集
```

### 5. **数据质量检查**

#### ✅ 质量标准
- 音频清晰，无严重失真
- 包含完整的声音事件
- 与热水器开关声音有明显区别
- 时长适中（2-8秒）

#### 🔍 检查工具
```python
# 使用分析脚本检查音频质量
python analyze_heater_sounds.py

# 检查项目:
- 采样率是否一致
- 音频长度分布
- 频谱特征差异
- RMS能量水平
```

### 6. **数据增强建议**

#### 🔄 自动增强
```bash
# 运行高级数据增强
python improved_data_augmentation.py

# 生成:
- 30个合成负样本
- 42个增强正样本 (6原始 × 7变换)
```

#### 🎛️ 手动增强
- 调整音量大小
- 添加轻微背景噪音
- 模拟不同距离录音
- 改变录音环境（房间大小、材质）

### 7. **避免的陷阱**

#### ❌ 常见错误
```
🚫 数据泄露
- 不要使用热水器开关的变形版本作为负样本
- 避免包含热水器开关声音的复合音频

🚫 分布偏差
- 不要只收集某一类型的负样本
- 避免所有负样本都来自同一环境

🚫 质量问题
- 避免音频过短（<1秒）或过长（>10秒）
- 不要使用严重失真的音频
```

### 8. **效果评估**

#### 📊 训练后评估
```python
# 重新训练模型
python wav2vec2_switch_detector.py

# 评估指标:
- 准确率 (Accuracy)
- 精确率 (Precision) - 减少误报
- 召回率 (Recall) - 不漏检真实开关声音
- F1分数 - 综合评估
```

#### 🎯 实际测试
```python
# 实时测试
python realtime_mic_detector.py

# 测试场景:
- 正常家庭环境
- 有人说话时
- 其他电器工作时
- 不同时间段（白天/夜晚）
```

## 💡 最佳实践

1. **渐进式收集**: 先收集明显不同的负样本，再收集边界案例
2. **多样性优先**: 宁可少而精，也要保证类型多样性
3. **持续迭代**: 根据实际使用中的误报情况，针对性收集数据
4. **质量控制**: 定期检查和清理数据集
5. **版本管理**: 记录每次数据更新和模型性能变化

通过系统性的数据收集和增强，可以显著提高模型的鲁棒性和实用性！ 